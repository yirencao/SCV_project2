??include_app
rsconnect::deployApp()
install.packages("BiocManager")
install.packages("spDataLarge")
devtools::install_github("geocompr/geocompkg")
load("~/Documents/NTNU/Lausanne/EPFL/MATH-517/report/olav_used_files/data/chicago_maps_workspace.RData")
#Make the map
trip_total_map <- function(areas_trip_total, label_trip_total, revenue_pal) {
chicago_leaflet %>%
addPolygons(data=areas_trip_total,
fillColor=~revenue_pal(log10(areas_trip_total$trip_total)),
color="lightgrey",
weight=2,
fillOpacity=0.8,
highlightOptions = highlightOptions(
weight=3,
opacity=2,
color="azure1",
bringToFront=TRUE),
label=label_trip_total,
labelOptions=labelOptions(
style = list("font-weight" = "normal", padding = "3px 8px"),
textsize = "15px",
direction = "auto")) %>%
addLegend("bottomright",
pal = revenue_pal,
values = log10(areas_trip_total$trip_total),
title = "Trip total (in USD)",
opacity = 0.8,
labFormat = leaflet::labelFormat(
transform = function(x) 10^(x)))
}
#Commented out to save time
load("./olav_used_files/data/chicago_maps_workspace.RData")
#load("./olav_used_files/data/companies_time_workspace.RData")
library(tidyverse)
library(sf)
library(leaflet)
library(ggmap)
library(mapview)
library(rgdal)
library(RColorBrewer)
library(janitor)
library(lubridate)
library(boot)
library(ggplot2)
library(gganimate)
library(gifski)
citation("ggmap")
#Make the map
trip_total_map <- function(areas_trip_total, label_trip_total, revenue_pal) {
chicago_leaflet %>%
addPolygons(data=areas_trip_total,
fillColor=~revenue_pal(log10(areas_trip_total$trip_total)),
color="lightgrey",
weight=2,
fillOpacity=0.8,
highlightOptions = highlightOptions(
weight=3,
opacity=2,
color="azure1",
bringToFront=TRUE),
label=label_trip_total,
labelOptions=labelOptions(
style = list("font-weight" = "normal", padding = "3px 8px"),
textsize = "15px",
direction = "auto")) %>%
addLegend("bottomright",
pal = revenue_pal,
values = log10(areas_trip_total$trip_total),
title = "Trip total (in USD)",
opacity = 0.8,
labFormat = leaflet::labelFormat(
transform = function(x) 10^(x)))
}
#trip_total_map(areas_trip_total, label_trip_total, revenue_pal)
avg_waiting_time_map <- function(areas_pickup_time, label_avg_pickup_time, time_pal) {
chicago_leaflet %>%
addPolygons(data=areas_pickup_time,
fillColor=~time_pal(areas_pickup_time$avg_pickup_time),
color="lightgrey",
weight=2,
fillOpacity=0.8,
highlightOptions = highlightOptions(
weight=3,
opacity=2,
color="azure1",
bringToFront=TRUE),
label=label_avg_pickup_time,
labelOptions=labelOptions(
style = list("font-weight" = "normal", padding = "3px 8px"),
textsize = "15px",
direction = "auto")) %>%
addLegend("bottomright",
pal = time_pal,
labFormat = function(type, cuts, p) {  # To get custom labels
paste0(waiting_time_labels)
},
values = areas_pickup_time$avg_pickup_time,
title = "Average time between pickup and dropoff",
opacity = 0.8)
}
#avg_waiting_time_map(areas_pickup_time, label_avg_pickup_time, time_pal)
expected_hourly_rate_map <- function(areas_hourly_rate, label_avg_hourly_rate, hourly_pal, hourly_labels) {
chicago_leaflet %>%
addPolygons(data=areas_hourly_rate,
fillColor=~hourly_pal(areas_hourly_rate$hourly_rate),
color="lightgrey",
weight=2,
fillOpacity=0.8,
highlightOptions = highlightOptions(
weight=3,
opacity=2,
color="azure1",
bringToFront=TRUE),
label=label_avg_hourly_rate,
labelOptions=labelOptions(
style = list("font-weight" = "normal", padding = "3px 8px"),
textsize = "15px",
direction = "auto")) %>%
addLegend("bottomright",
pal = hourly_pal,
labFormat = function(type, cuts, p) {  # To get custom labels
paste0(hourly_labels)
},
values = areas_hourly_rate$hourly_rate,
title = "Average hourly rate",
opacity = 0.8)
}
avg_waiting_time_map <- function(areas_pickup_time, label_avg_pickup_time, waiting_time_labels, time_pal) {
chicago_leaflet %>%
addPolygons(data=areas_pickup_time,
fillColor=~time_pal(areas_pickup_time$avg_pickup_time),
color="lightgrey",
weight=2,
fillOpacity=0.8,
highlightOptions = highlightOptions(
weight=3,
opacity=2,
color="azure1",
bringToFront=TRUE),
label=label_avg_pickup_time,
labelOptions=labelOptions(
style = list("font-weight" = "normal", padding = "3px 8px"),
textsize = "15px",
direction = "auto")) %>%
addLegend("bottomright",
pal = time_pal,
labFormat = function(type, cuts, p) {  # To get custom labels
paste0(waiting_time_labels)
},
values = areas_pickup_time$avg_pickup_time,
title = "Average time between pickup and dropoff",
opacity = 0.8)
}
#avg_waiting_time_map(areas_pickup_time, label_avg_pickup_time, waiting_time_labels, time_pal)
save.image("~/Documents/NTNU/Lausanne/EPFL/MATH-517/report/olav_used_files/data/chicago_maps_workspace.RData")
load("./olav_used_files/data/chicago_maps_workspace.RData")
#Make the map
trip_total_map <- function(chicago_leaflet, areas_trip_total, label_trip_total, revenue_pal) {
chicago_leaflet %>%
addPolygons(data=areas_trip_total,
fillColor=~revenue_pal(log10(areas_trip_total$trip_total)),
color="lightgrey",
weight=2,
fillOpacity=0.8,
highlightOptions = highlightOptions(
weight=3,
opacity=2,
color="azure1",
bringToFront=TRUE),
label=label_trip_total,
labelOptions=labelOptions(
style = list("font-weight" = "normal", padding = "3px 8px"),
textsize = "15px",
direction = "auto")) %>%
addLegend("bottomright",
pal = revenue_pal,
values = log10(areas_trip_total$trip_total),
title = "Trip total (in USD)",
opacity = 0.8,
labFormat = leaflet::labelFormat(
transform = function(x) 10^(x)))
}
#trip_total_map(chicago_leaflet, areas_trip_total, label_trip_total, revenue_pal)
avg_waiting_time_map <- function(chicago_leaflet, areas_pickup_time, label_avg_pickup_time, waiting_time_labels, time_pal) {
chicago_leaflet %>%
addPolygons(data=areas_pickup_time,
fillColor=~time_pal(areas_pickup_time$avg_pickup_time),
color="lightgrey",
weight=2,
fillOpacity=0.8,
highlightOptions = highlightOptions(
weight=3,
opacity=2,
color="azure1",
bringToFront=TRUE),
label=label_avg_pickup_time,
labelOptions=labelOptions(
style = list("font-weight" = "normal", padding = "3px 8px"),
textsize = "15px",
direction = "auto")) %>%
addLegend("bottomright",
pal = time_pal,
labFormat = function(type, cuts, p) {  # To get custom labels
paste0(waiting_time_labels)
},
values = areas_pickup_time$avg_pickup_time,
title = "Average time between pickup and dropoff",
opacity = 0.8)
}
#avg_waiting_time_map(chicago_leaflet, areas_pickup_time, label_avg_pickup_time, waiting_time_labels, time_pal)
expected_hourly_rate_map <- function(chicago_leaflet, areas_hourly_rate, label_avg_hourly_rate, hourly_pal, hourly_labels) {
chicago_leaflet %>%
addPolygons(data=areas_hourly_rate,
fillColor=~hourly_pal(areas_hourly_rate$hourly_rate),
color="lightgrey",
weight=2,
fillOpacity=0.8,
highlightOptions = highlightOptions(
weight=3,
opacity=2,
color="azure1",
bringToFront=TRUE),
label=label_avg_hourly_rate,
labelOptions=labelOptions(
style = list("font-weight" = "normal", padding = "3px 8px"),
textsize = "15px",
direction = "auto")) %>%
addLegend("bottomright",
pal = hourly_pal,
labFormat = function(type, cuts, p) {  # To get custom labels
paste0(hourly_labels)
},
values = areas_hourly_rate$hourly_rate,
title = "Average hourly rate",
opacity = 0.8)
}
#expected_hourly_rate_map(chicago_leaflet, areas_hourly_rate, label_avg_hourly_rate, hourly_pal, hourly_labels)
save.image("~/Documents/NTNU/Lausanne/EPFL/MATH-517/report/olav_used_files/data/chicago_maps_workspace.RData")
